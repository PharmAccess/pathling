{
  "title": "union",
  "description": "Union used to unify different branches of resource into flat table",
  "resources": [
    {
      "resourceType": "Patient",
      "id": "pt1",
      "contact": [
        {
          "telecom": [
            {
              "system": "phone",
              "value": "1"
            },
            {
              "system": "phone",
              "value": "2"
            }
          ]
        }
      ],
      "telecom": [
        {
          "system": "phone",
          "value": "3"
        },
        {
          "system": "phone",
          "value": "4"
        }
      ]
    }
  ],
  "tests": [
    {
      "title": "union all telecoms",
      "view": {
        "resource": "Patient",
        "select": [
          {
            "column": [
              {
                "name": "id",
                "path": "id"
              }
            ],
            "unionAll": [
              {
                "column": [
                  {
                    "name": "phone",
                    "path": "telecom.value",
                    "collection": true
                  },
                  {
                    "name": "phone",
                    "path": "contact.telecom.value",
                    "collection": true
                  }
                ]
              }
            ]
          }
        ]
      },
      "expect": [
        {
          "id": "pt1",
          "phone": [ "3", "4" , "1", "2" ]
        }
      ]
    }
  ]
}
