"use strict";(self.webpackChunkpathling_site=self.webpackChunkpathling_site||[]).push([[880],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>c});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),p=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},g={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),h=p(r),c=a,d=h["".concat(l,".").concat(c)]||h[c]||g[c]||i;return r?n.createElement(d,o(o({ref:t},u),{},{components:r})):n.createElement(d,o({ref:t},u))}));function c(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var p=2;p<i;p++)o[p]=r[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},190:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>g,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var n=r(7462),a=(r(7294),r(3905));const i={sidebar_position:3},o="Aggregate",s={unversionedId:"server/operations/aggregate",id:"server/operations/aggregate",title:"Aggregate",description:"FHIR OperationDefinition",source:"@site/docs/server/operations/aggregate.md",sourceDirName:"server/operations",slug:"/server/operations/aggregate",permalink:"/docs/server/operations/aggregate",draft:!1,editUrl:"https://github.com/aehrc/pathling/tree/main/site/docs/server/operations/aggregate.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"server",previous:{title:"Search",permalink:"/docs/server/operations/search"},next:{title:"Extract",permalink:"/docs/server/operations/extract"}},l={},p=[{value:"Request",id:"request",level:2},{value:"Response",id:"response",level:2},{value:"Examples",id:"examples",level:2}],u={toc:p};function g(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,n.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"aggregate"},"Aggregate"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://pathling.csiro.au/fhir/OperationDefinition/aggregate-6"},"FHIR OperationDefinition")),(0,a.kt)("p",null,"This operation allows a user to perform aggregate queries on data held within\nthe FHIR server. You call the operation by specifying aggregation, grouping and\nfilter expressions, and grouped results are returned."),(0,a.kt)("p",null,"The aggregate operation is useful for exploratory data analysis, as well as\npowering visualizations and other summarized views of the data. Drill-down\nexpressions returned within the response can be used with the ",(0,a.kt)("a",{parentName:"p",href:"./search"},"search"),"\noperation to retrieve the resources that make up each grouped result."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The ",(0,a.kt)("inlineCode",{parentName:"p"},"aggregate")," operation supports the ",(0,a.kt)("a",{parentName:"p",href:"../async"},"Asynchronous Request Pattern"),",\nwhich allows you to kick off a long-running request and check on its progress\nusing a status endpoint.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"GET [FHIR endpoint]/[resource type]/$aggregate?[parameters...]\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"POST [FHIR endpoint]/[resource type]/$aggregate\n")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Aggregate",src:r(4638).Z+"#light-mode-only",title:"Aggregate",width:"667",height:"449"}),"\n",(0,a.kt)("img",{alt:"Aggregate",src:r(7244).Z+"#dark-mode-only",title:"Aggregate",width:"667",height:"454"})),(0,a.kt)("h2",{id:"request"},"Request"),(0,a.kt)("p",null,"The request for the ",(0,a.kt)("inlineCode",{parentName:"p"},"$aggregate")," operation is either a GET request, or a POST\nrequest containing a ",(0,a.kt)("a",{parentName:"p",href:"https://hl7.org/fhir/R4/parameters.html"},"Parameters"),"\nresource. The following parameters are supported:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"aggregation [1..*]")," - (string) A FHIRPath expression which is used to\ncalculate a summary value from each grouping. The context is a collection of\nresources of the subject resource type. The expression must return a\n",(0,a.kt)("a",{parentName:"li",href:"/docs/fhirpath/data-types#materializable-types"},"materializable type")," and also\nbe\nsingular."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"grouping [0..*]")," - (string) A FHIRPath expression that can be evaluated\nagainst each resource in the data set to determine which groupings it should\nbe counted within. The context is an individual resource of the subject\nresource type. The expression must return a\n",(0,a.kt)("a",{parentName:"li",href:"/docs/fhirpath/data-types#materializable-types"},"materializable type"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"filter [0..*]")," - (string) A FHIRPath expression that can be evaluated against\neach resource in the data set to determine whether it is included within the\nresult. The context is an individual resource of the subject resource type.\nThe expression must evaluate to a Boolean value. Multiple filters are combined\nusing AND logic.")),(0,a.kt)("h2",{id:"response"},"Response"),(0,a.kt)("p",null,"The response for the ",(0,a.kt)("inlineCode",{parentName:"p"},"$aggregate")," operation is a\n",(0,a.kt)("a",{parentName:"p",href:"https://hl7.org/fhir/R4/parameters.html"},"Parameters")," resource containing the\nfollowing parameters:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"grouping [0..*]")," - The grouped results of the aggregations requested in the\nquery. There will be one grouping for each distinct combination of values\ndetermined by executing the grouping expressions against each of the resources\nwithin the filtered set of subject resources.",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"label [0..*]")," - (",(0,a.kt)("a",{parentName:"li",href:"https://hl7.org/fhir/R4/datatypes.html#primitive"},"Type"),")\nThe set of descriptive labels that describe this grouping, corresponding to\nthose requested in the query. There will be one label for each grouping\nwithin the query, and the type of each label will correspond to the type\nreturned by the expression of the corresponding grouping. A grouping\nexpression that results in an empty collection will yield a null label,\nwhich is represented within FHIR as the absence of a value."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"result [1..*]")," - (",(0,a.kt)("a",{parentName:"li",href:"https://hl7.org/fhir/R4/datatypes.html#primitive"},"Type"),")\nThe set of values that resulted from the execution of the aggregations that\nwere requested in the query. There will be one result for each aggregation\nwithin the query, and the type of each result will correspond to the type\nreturned by the expression of the corresponding aggregation."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"drillDown [0..1]")," - (string) A FHIRPath expression that can be used as a\nfilter to retrieve the set of resources that are members of this grouping.\nThis will be omitted if there were no groupings or filters passed within the\nquery.")))),(0,a.kt)("h2",{id:"examples"},"Examples"),(0,a.kt)("p",null,"Check out example ",(0,a.kt)("inlineCode",{parentName:"p"},"aggregate")," requests in the Postman collection:"),(0,a.kt)("a",{class:"postman-link",href:"https://documenter.getpostman.com/view/634774/UVsQs48s#83ef69d8-0cb7-43c2-9f43-f55ffb3ed940"},(0,a.kt)("img",{src:"https://run.pstmn.io/button.svg",alt:"Run in Postman"})))}g.isMDXComponent=!0},7244:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/aggregate-dark-12701985341956c1762632d482b47c67.svg"},4638:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/aggregate-a35ba364ea611eba016dd3b99978f3e7.svg"}}]);