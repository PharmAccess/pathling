"use strict";(self.webpackChunkpathling_site=self.webpackChunkpathling_site||[]).push([[184],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=s(n),d=r,h=u["".concat(p,".").concat(d)]||u[d]||c[d]||l;return n?a.createElement(h,i(i({ref:t},m),{},{components:n})):a.createElement(h,i({ref:t},m))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=d;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o[u]="string"==typeof e?e:r,i[1]=o;for(var s=2;s<l;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5028:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));const l={sidebar_position:4},i="Extract",o={unversionedId:"server/operations/extract",id:"server/operations/extract",title:"Extract",description:"FHIR OperationDefinition",source:"@site/docs/server/operations/extract.md",sourceDirName:"server/operations",slug:"/server/operations/extract",permalink:"/docs/server/operations/extract",draft:!1,editUrl:"https://github.com/aehrc/pathling/tree/main/site/docs/server/operations/extract.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"server",previous:{title:"Aggregate",permalink:"/docs/server/operations/aggregate"},next:{title:"Update and batch",permalink:"/docs/server/operations/update"}},p={},s=[{value:"Request",id:"request",level:2},{value:"Response",id:"response",level:2},{value:"Notes",id:"notes",level:2},{value:"Examples",id:"examples",level:2}],m={toc:s};function u(e){let{components:t,...l}=e;return(0,r.kt)("wrapper",(0,a.Z)({},m,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"extract"},"Extract"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://pathling.csiro.au/fhir/OperationDefinition/extract-6"},"FHIR OperationDefinition")),(0,r.kt)("p",null,"This operation allows a user to create arbitrary tabular extracts from FHIR\ndata, by specifying columns in terms of set of FHIRPath expressions that are\nused to populate them. A URL is returned that points to a delimited text file\nthat contains the result of executing the expressions against each subject\nresource."),(0,r.kt)("p",null,"The extract operation is useful for preparing data for use within other tools,\nand helps to alleviate some of the burden of dealing with FHIR data in its raw\nform."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"aggregate")," operation supports the ",(0,r.kt)("a",{parentName:"p",href:"../async"},"Asynchronous Request Pattern"),",\nwhich allows you to kick off a long-running request and check on its progress\nusing a status endpoint.")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If you request a column with the ",(0,r.kt)("inlineCode",{parentName:"p"},"Coding")," type, it will be expressed within the\nresulting extract using\nthe ",(0,r.kt)("a",{parentName:"p",href:"/docs/fhirpath/data-types#coding"},"Coding literal format"),".")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"GET [FHIR endpoint]/[resource type]/$extract?[parameters...]\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"POST [FHIR endpoint]/[resource type]/$extract\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Extract",src:n(9931).Z+"#light-mode-only",title:"Extract",width:"595",height:"389"}),"\n",(0,r.kt)("img",{alt:"Extract",src:n(2634).Z+"#dark-mode-only",title:"Extract",width:"595",height:"389"})),(0,r.kt)("h2",{id:"request"},"Request"),(0,r.kt)("p",null,"The request for the ",(0,r.kt)("inlineCode",{parentName:"p"},"$extract")," operation is either a GET request, or a POST\nrequest containing a ",(0,r.kt)("a",{parentName:"p",href:"https://hl7.org/fhir/R4/parameters.html"},"Parameters"),"\nresource. The following parameters are supported:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"column [1..*]")," - (string) A FHIRPath expression that defines a column within\nthe result. The context is a single resource of the subject resource type.\nThe expression must return a\n",(0,r.kt)("a",{parentName:"li",href:"/docs/fhirpath/data-types#materializable-types"},"materializable type"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"filter [0..*]")," - (string) A FHIRPath expression that can be evaluated against\neach resource in the data set to determine whether it is included within the\nresult. The context is an individual resource of the subject resource type.\nThe expression must evaluate to a Boolean value. Multiple filters are combined\nusing AND logic."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"limit [0..1]")," - (integer) The maximum number of rows to return.")),(0,r.kt)("h2",{id:"response"},"Response"),(0,r.kt)("p",null,"The response for the ",(0,r.kt)("inlineCode",{parentName:"p"},"$extract")," operation is a\n",(0,r.kt)("a",{parentName:"p",href:"https://hl7.org/fhir/R4/parameters.html"},"Parameters")," resource containing the\nfollowing parameters:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"url [1]")," - A URL at which the result of the operation can be retrieved.")),(0,r.kt)("h2",{id:"notes"},"Notes"),(0,r.kt)("p",null,"The way that the columns are combined within the extract operation is a bit\ndifferent to the ",(0,r.kt)("a",{parentName:"p",href:"./aggregate"},"aggregate")," operation - rows are matched on the\nnearest common ancestor element. What this means is that if you are creating\ncolumns from nested data, the nested groupings will be kept together and any\ninvalid combinations of values across multiple columns will be eliminated."),(0,r.kt)("p",null,"As an example - given a set of Patient resources:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"id"),(0,r.kt)("th",{parentName:"tr",align:null},"name.given"),(0,r.kt)("th",{parentName:"tr",align:null},"name.family"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"Benjamin"),(0,r.kt)("td",{parentName:"tr",align:null},"Franklin")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"Silence"),(0,r.kt)("td",{parentName:"tr",align:null},"Dogood")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"Isaac"),(0,r.kt)("td",{parentName:"tr",align:null},"Asimov")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"Paul"),(0,r.kt)("td",{parentName:"tr",align:null},"French")))),(0,r.kt)("p",null,"And the following query:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "resourceType": "Parameters",\n  "parameter": [\n    {\n      "name": "column",\n      "valueString": "name.given"\n    },\n    {\n      "name": "column",\n      "valueString": "name.family"\n    }\n  ]\n}\n')),(0,r.kt)("p",null,"We would get the following result:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Given name"),(0,r.kt)("th",{parentName:"tr",align:null},"Family name"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Benjamin"),(0,r.kt)("td",{parentName:"tr",align:null},"Franklin")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Silence"),(0,r.kt)("td",{parentName:"tr",align:null},"Dogood")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Isaac"),(0,r.kt)("td",{parentName:"tr",align:null},"Asimov")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Paul"),(0,r.kt)("td",{parentName:"tr",align:null},"French")))),(0,r.kt)("p",null,"Rather than:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Given name"),(0,r.kt)("th",{parentName:"tr",align:null},"Family name"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Benjamin"),(0,r.kt)("td",{parentName:"tr",align:null},"Franklin")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Benjamin"),(0,r.kt)("td",{parentName:"tr",align:null},"Dogood")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Silence"),(0,r.kt)("td",{parentName:"tr",align:null},"Franklin")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Silence"),(0,r.kt)("td",{parentName:"tr",align:null},"Dogood")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Isaac"),(0,r.kt)("td",{parentName:"tr",align:null},"Asimov")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Isaac"),(0,r.kt)("td",{parentName:"tr",align:null},"French")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Paul"),(0,r.kt)("td",{parentName:"tr",align:null},"Asimov")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Paul"),(0,r.kt)("td",{parentName:"tr",align:null},"French")))),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)("p",null,"Check out example ",(0,r.kt)("inlineCode",{parentName:"p"},"extract")," requests in the Postman collection:"),(0,r.kt)("a",{class:"postman-link",href:"https://documenter.getpostman.com/view/634774/UVsQs48s#1aa5cb8f-6931-417c-be20-d295a05af8ed"},(0,r.kt)("img",{src:"https://run.pstmn.io/button.svg",alt:"Run in Postman"})))}u.isMDXComponent=!0},2634:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/extract-dark-a7a07403b94ff995d8574c5415e7867a.svg"},9931:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/extract-463a82e90b3d800b1b038dc9fb4190a9.svg"}}]);